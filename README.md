# Protein Sequence Similarity Search Toolkit

Jupyter Notebook предназначен для **поиска и оценки схожести аминокислотных последовательностей белков** с использованием нескольких алгоритмов. Он загружает данные из FASTA-файлов, обучает (где необходимо) модели на подмножестве данных, а затем оценивает, насколько хорошо каждая модель ранжирует последовательности по схожести с заданной последовательностью.

---

## Основные компоненты

### 1. `evaluate_similarity_method(...)`

**Назначение:**  
Функция для оценки метода сравнения последовательностей. Принимает на вход:

- `file_path` — путь к FASTA-файлу с последовательностями.
- `fitted_model` — объект модели, реализующий метод `.predict(query, sequences)`.
- `method_name` — название метода для отчета.
- `max_sequences` — максимальное количество последовательностей для анализа (ограничение для тяжелых методов, например, Левенштейна).

**Что делает:**

1. Загружает последовательности из FASTA (фильтрует короткие — <10 аминокислот).
2. Берет первую последовательность как **запросную (query)**.
3. Вычисляет схожесть запроса со всеми остальными с помощью `model.predict(...)`.
4. Выводит топ-10 наиболее похожих последовательностей.
5. Рассчитывает метрики качества ранжирования:
   - **Spearman correlation** — корреляция рангов (ground truth = порядок в файле, predicted = по схожести).
   - **Pearson correlation**
   - **NDCG@10 и NDCG@all** — качество ранжирования (чем ближе к 1, тем лучше).
   - **Kendall’s Tau** — еще одна мера корреляции рангов.
6. Возвращает словарь с метриками для сравнения моделей.

---

## Реализованные модели схожести

### 1. `LevenshteinSimilarityModel`

- **Базовый функционал**:  
  Использует расстояние Левенштейна — минимальное количество вставок, удалений, замен для превращения одной строки в другую.
- **Схожесть**: `1 - (distance / max(len(seq1), len(seq2)))`
- **Плюсы**: Точно учитывает локальные изменения.
- **Минусы**: Очень медленный на длинных последовательностях, не учитывает биологический контекст.

---

### 2. `LengthSimilarityModel`

- **Базовый функционал**:  
  Сравнивает только длины последовательностей.
- **Схожесть**: `1 - |len1 - len2| / max(len1, len2)`
- **Плюсы**: Очень быстрый.
- **Минусы**: Не учитывает содержание, только длину — крайне грубая оценка.

---

### 3. `ExactMatchSimilarityModel`

- **Базовый функционал**:  
  Возвращает 1.0, если последовательность полностью совпадает с запросом, иначе 0.0.
- **Плюсы**: Точное совпадение.
- **Минусы**: Практически бесполезен для поиска *похожих*, но не идентичных белков.

---

### 4. `PreFittedGensimFastTextSimilarityModel`

- **Базовый функционал**:  
  Разбивает последовательности на k-меры (например, 3-граммы аминокислот), обучает модель FastText на них, получает векторное представление каждой последовательности как среднее векторов её k-меров, сравнивает через косинусное сходство.
- **Плюсы**: Учитывает локальные паттерны, обучается на данных, работает быстро после обучения.
- **Минусы**: Качество зависит от параметров (k, vector_size, epochs) и объема обучающей выборки.

---

### 5. `PreFittedKmerTfidfSimilarityModel`

- **Базовый функционал**:  
  Аналогично FastText, но вместо эмбеддингов использует TF-IDF векторизацию k-меров. Сравнение — косинусное сходство.
- **Плюсы**: Простой, интерпретируемый, не требует глубокого обучения.
- **Минусы**: Не улавливает семантическую близость k-меров, только статистическую частоту.

---

## Метрики оценки

- **Spearman / Pearson correlation**: Насколько ранжирование модели коррелирует с "ground truth".
- **NDCG@10**: Качество топ-10 результатов (идеал = 1.0).
- **Kendall’s Tau**: Альтернативная мера корреляции рангов.
- **Вывод топ-10**: Самые похожие последовательности с ID и началом строки.

## Чтобы найти похожую последовательность 

    def find_closest_in_fitted_set(self, query_sequence: str, fitted_sequences: List[str]) -> Tuple[str, float]:
